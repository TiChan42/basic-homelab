all:
  vars:
    # Shared SSH defaults for all managed hosts
    ansible_user: root
    ansible_ssh_private_key_file: /root/.ssh/id_rsa
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'
  children:
    traefik:
      hosts:
        traefik:
          ansible_host: "192.168.1.100"
          service_name: "traefik"
          service_id: "100"
          service_frontend_port: "80"
          service_backend_port: "80"
          traefik_https_port: "443"
          traefik_dashboard_port: "50100"
          service_traefik:
            enabled: true
            domain: "traefik.home.local"

    mqtt_brokers:
      hosts:
        mqtt-broker:
          ansible_host: "192.168.1.101"
          service_name: "mqtt"
          service_id: "101"
          service_frontend_port: "50101"
          service_backend_port: "1883"
          service_websocket_port: "9001"
          service_traefik:
            enabled: false

    homeassistant:
      hosts:
        homeassistant:
          ansible_host: "192.168.1.102"
          service_name: "ha"
          service_id: "102"
          service_backend_port: "8123"
          service_traefik:
            enabled: true
            domain: "ha.home.local"
            api_domain: "api.ha.home.local"
            ws_domain: "socket.ha.home.local"

    nodered:
      hosts:
        nodered:
          ansible_host: "192.168.1.103"
          service_name: "nodered"
          service_id: "103"
          service_frontend_port: "50103"
          service_backend_port: "1880"
          service_traefik:
            enabled: true
            domain: "nodered.home.local"
            api_domain: "api.nodered.home.local"
            ws_domain: "socket.nodered.home.local"

    n8n:
      hosts:
        n8n:
          ansible_host: "192.168.1.104"
          service_name: "n8n"
          service_id: "104"
          service_frontend_port: "50104"
          service_backend_port: "5678"
          service_traefik:
            enabled: true
            domain: "n8n.home.local"
            api_domain: "api.n8n.home.local"
            ws_domain: "socket.n8n.home.local"
        # ---------------------------------------------------------------
        # Example: Add another n8n instance by uncommenting below
        # ---------------------------------------------------------------
        # n8n-2:
        #   ansible_host: "192.168.1.108"
        #   service_name: "n8n2"
        #   service_id: "108"
        #   service_frontend_port: "50108"
        #   service_backend_port: "5678"
        #   service_traefik:
        #     enabled: true
        #     domain: "n8n2.home.local"

    webservers:
      vars:
        # Defaults for all webservers (can be overridden per host)
        webserver_container_memory: "512"
        webserver_container_cores: "1"
        webserver_container_rootfs: "{{ default_storage }}:8"
        webserver_node_version: "22"
        webserver_build_command: "npm run build"
      hosts:
        desktop-background-webserver:
          ansible_host: "192.168.1.105"
          service_name: "desktop-bg"
          service_id: "105"
          service_frontend_port: "50105"
          service_backend_port: "3000"
          webserver_git_repo: "https://github.com/shape-z/windowmesh.git"
          webserver_git_branch: "main"
          service_traefik:
            enabled: true
            domain: "desktop-bg.home.local"
        # ---------------------------------------------------------------
        # Example: Add another webserver by uncommenting below
        # ---------------------------------------------------------------
        # my-portfolio:
        #   ansible_host: "192.168.1.109"
        #   service_name: "portfolio"
        #   service_id: "109"
        #   service_frontend_port: "50109"
        #   service_backend_port: "3000"
        #   webserver_git_repo: "https://github.com/user/portfolio.git"
        #   webserver_git_branch: "main"
        #   webserver_build_command: "npm run build"  # override default
        #   service_traefik:
        #     enabled: true
        #     domain: "portfolio.home.local"