# ============================================
# n8n Environment Configuration â€“ managed by Ansible
# ============================================

# --- Network ---
N8N_HOST=0.0.0.0
N8N_PORT={{ service_backend_port }}
N8N_PROTOCOL=http
WEBHOOK_URL={{ n8n_webhook_url }}

# --- Storage ---
N8N_USER_FOLDER={{ n8n_data_dir }}
DB_TYPE=sqlite
DB_SQLITE_DATABASE={{ n8n_data_dir }}/database.sqlite

# --- Locale ---
GENERIC_TIMEZONE={{ n8n_timezone }}

# --- Security ---
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER={{ n8n_basic_auth_user }}
N8N_BASIC_AUTH_PASSWORD={{ n8n_basic_auth_password }}
N8N_ENCRYPTION_KEY={{ n8n_basic_auth_password | hash('sha256') | truncate(32, True, '') }}

# --- Telemetry ---
N8N_DIAGNOSTICS_ENABLED=false
N8N_HIRING_BANNER_ENABLED=false

# --- Inter-Service Connection: MQTT Broker ---
# Available as environment variables in n8n workflows via $env.MQTT_*
MQTT_BROKER_HOST={{ n8n_mqtt_broker_ip }}
MQTT_BROKER_PORT={{ n8n_mqtt_port }}
MQTT_BROKER_USER={{ n8n_mqtt_user }}
MQTT_BROKER_PASSWORD={{ n8n_mqtt_password }}

# --- Inter-Service Connection: Home Assistant ---
# Available as environment variables in n8n workflows via $env.HA_*
HA_URL={{ n8n_ha_url }}
HA_TOKEN={{ n8n_ha_token | default('') }}
